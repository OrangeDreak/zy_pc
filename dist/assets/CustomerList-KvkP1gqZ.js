import{r as L}from"./request-Db42XEdn.js";import{a as w}from"./orderList-CywECxmE.js";import{A as P}from"./AddressForm-CrDAA8jH.js";import{z as U,C as y,r as m,E as V,g as B,_ as E,c as q,o as _,d as n,a as s,e as d,w as l,t,F as O,q as b,i as T,x as Q}from"./index-CeCSaknX.js";import"./currency-DoSCd0KH.js";import"./index-C6gr9_Vt.js";import"./common-BTsuERNO.js";const H={getCustomerList(e){return L({url:"/app/user/subUserList",method:"post",data:e})}},M=U({name:"CustomerList",components:{AddressForm:P},setup(){const e=y({currentPage:1,pageSize:10}),r=B(),v=y({userNo:""}),g=m(!1),$=m([]),A=m(0),h=m(!1),i=m(null),p=m({}),u=async()=>{try{h.value=!0,i.value=null;let a={pageNo:e.currentPage,pageSize:e.pageSize,...v};const C=await H["getCustomerList"](a);$.value=C.data,A.value=C.total}catch(a){i.value=a.message||"获取客户失败",V.error("获取客户列表失败")}finally{h.value=!1}},F=()=>{e.currentPage=1,u()},c=async a=>{const{data:z}=await w.getSharingCode({userNo:a.userNo,orderId:a.id}),C=`${window.location.origin}/order-share-transfer?code=${z}`;navigator.clipboard.writeText(C).then(()=>{console.log("内容已成功复制到剪切板")}).catch(I=>{console.error("无法复制内容到剪切板:",I)}),V.success("分享订单成功")},N=()=>{p.value={},g.value=!0},S=a=>{p.value=a,g.value=!0},k=a=>{r.push("/orders?userNo="+a.userNo)},o=a=>{e.pageSize=a,u()},f=a=>{e.currentPage=a,u()},D=()=>{u()};return u(),{searchForm:v,customers:$,total:A,pagination:e,formData:p,handleSizeChange:o,handleCurrentChange:f,handleSearch:F,handleAddAddress:N,addressDialogVisible:g,handleAddressSubmit:D,handleEdit:S,handleStarClick:c,handleOrderLink:k}}}),R={class:"order-list"},j={class:"search-toolbar"},G={class:"order-list-content"},J={class:"user-info"},K=["onClick"],W={class:"pagination"},X={class:"total"};function Y(e,r,v,g,$,A){const h=d("el-input"),i=d("el-button"),p=d("QuestionFilled"),u=d("el-icon"),F=d("el-tooltip"),c=d("el-table-column"),N=d("el-table"),S=d("el-pagination"),k=d("AddressForm");return _(),q(O,null,[n("div",R,[n("div",j,[s(h,{modelValue:e.searchForm.userNo,"onUpdate:modelValue":r[0]||(r[0]=o=>e.searchForm.userNo=o),placeholder:e.$t("order.toolbar.customerSearch"),class:"search-input"},null,8,["modelValue","placeholder"]),s(i,{onClick:e.handleSearch},{default:l(()=>[b(t(e.$t("header.searchButton")),1)]),_:1},8,["onClick"]),s(i,{type:"primary",link:"",class:"new-address",onClick:e.handleAddAddress},{default:l(()=>[b(t(e.$t("customers.add"))+" ",1),s(F,{content:e.$t("customers.addressHelp"),placement:"top"},{default:l(()=>[s(u,{class:"address-help"},{default:l(()=>[s(p)]),_:1})]),_:1},8,["content"])]),_:1},8,["onClick"])]),n("div",G,[s(N,{data:e.customers,style:{width:"100%"},stripe:""},{default:l(()=>[s(c,{prop:"userNo",label:e.$t("customers.code"),width:"150"},null,8,["label"]),s(c,{prop:"userNo",label:e.$t("customers.info.title")},{default:l(({row:o})=>[n("div",J,[n("div",null,[n("div",null,t(e.$t("customers.info.name"))+"："+t(o.userAddressInfo.firstName),1),n("div",null,t(e.$t("customers.info.postcode"))+"："+t(o.userAddressInfo.postcode),1),n("div",null,t(e.$t("customers.info.phoneNumber"))+"："+t(o.userAddressInfo.mobile),1),n("div",null,t(e.$t("customers.info.email"))+"："+t(o.userAddressInfo.email),1),n("div",null,t(e.$t("customers.info.address"))+"："+t(o.userAddressInfo.countryName)+" "+t(o.userAddressInfo.provinceName)+" "+t(o.userAddressInfo.cityName)+" "+t(o.userAddressInfo.address),1)])])]),_:1},8,["label"]),s(c,{prop:"orderCount",label:e.$t("customers.orderCount"),width:"130"},{default:l(({row:o})=>[n("div",{onClick:f=>e.handleOrderLink(o),class:"text-cursor"},t(e.$t("customers.orderCount"))+"："+t(o.orderCount),9,K)]),_:1},8,["label"]),s(c,{prop:"gmtCreate",label:e.$t("commont.createTime"),width:"180"},null,8,["label"]),s(c,{prop:"statusDesc",label:e.$t("commont.operation"),width:"130"},{default:l(o=>[s(i,{type:"text",onClick:f=>e.handleEdit(o.row)},{default:l(()=>[b(t(e.$t("commont.edit")),1)]),_:2},1032,["onClick"]),o.row.orderCount?(_(),T(i,{key:0,type:"text",icon:"el-icon-star-on",class:"star-btn",onClick:f=>e.handleStarClick(o.row)},{default:l(()=>[b(t(e.$t("commont.share")),1)]),_:2},1032,["onClick"])):Q("",!0)]),_:1},8,["label"])]),_:1},8,["data"])]),n("div",W,[n("div",X,t(e.$t("commont.total"))+" "+t(e.total)+" "+t(e.$t("commont.page")),1),s(S,{"current-page":e.pagination.currentPage,"onUpdate:currentPage":r[1]||(r[1]=o=>e.pagination.currentPage=o),"page-size":e.pagination.pageSize,"onUpdate:pageSize":r[2]||(r[2]=o=>e.pagination.pageSize=o),"page-sizes":[10,20,50],total:e.total,layout:"prev, pager, next, sizes",onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),s(k,{modelValue:e.addressDialogVisible,"onUpdate:modelValue":r[3]||(r[3]=o=>e.addressDialogVisible=o),formData:e.formData,subCode:e.formData.userNo,onSubmit:e.handleAddressSubmit},null,8,["modelValue","formData","subCode","onSubmit"])],64)}const ne=E(M,[["render",Y],["__scopeId","data-v-9f6f65c1"]]);export{ne as default};
