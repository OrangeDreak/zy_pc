import{r as I}from"./request-Ci6vZ18k.js";import{a as L}from"./orderList-oxbKkESx.js";import{A as E}from"./AddressForm-OYLk7KNn.js";import{a5 as P,x as y,r as c,E as _,u as B,_ as U,c as w,b as V,d as n,e as s,f as d,w as l,t,F as q,j as C,l as O,m as Q}from"./index-CAD5YEHZ.js";import"./auth-BVoTKOlD.js";const T={getCustomerList(e){return I({url:"/app/user/subUserList",method:"post",data:e})}},j=P({name:"CustomerList",components:{AddressForm:E},setup(){const e=y({currentPage:1,pageSize:10}),r=B(),b=y({userNo:""}),g=c(!1),v=c([]),$=c(0),h=c(!1),u=c(null),p=c({}),i=async()=>{try{h.value=!0,u.value=null;let a={pageNo:e.currentPage,pageSize:e.pageSize,...b};const z=await T["getCustomerList"](a);v.value=z.data,$.value=z.total}catch(a){u.value=a.message||"获取客户失败",_.error("获取客户列表失败")}finally{h.value=!1}},F=()=>{e.currentPage=1,i()},m=async a=>{const{data:k}=await L.getSharingCode({userNo:a.userNo,orderId:a.id});_.success(`分享订单：${k.trackingNo}`)},A=()=>{p.value={},g.value=!0},N=a=>{p.value=a,g.value=!0},S=a=>{r.push("/orders?userNo="+a.userNo)},o=a=>{e.pageSize=a,i()},f=a=>{e.currentPage=a,i()},D=()=>{i()};return i(),{searchForm:b,customers:v,total:$,pagination:e,formData:p,handleSizeChange:o,handleCurrentChange:f,handleSearch:F,handleAddAddress:A,addressDialogVisible:g,handleAddressSubmit:D,handleEdit:N,handleStarClick:m,handleOrderLink:S}}}),M={class:"order-list"},R={class:"search-toolbar"},G={class:"order-list-content"},H={class:"user-info"},J=["onClick"],K={class:"pagination"},W={class:"total"};function X(e,r,b,g,v,$){const h=d("el-input"),u=d("el-button"),p=d("QuestionFilled"),i=d("el-icon"),F=d("el-tooltip"),m=d("el-table-column"),A=d("el-table"),N=d("el-pagination"),S=d("AddressForm");return V(),w(q,null,[n("div",M,[n("div",R,[s(h,{modelValue:e.searchForm.userNo,"onUpdate:modelValue":r[0]||(r[0]=o=>e.searchForm.userNo=o),placeholder:e.$t("order.toolbar.customerSearch"),class:"search-input"},null,8,["modelValue","placeholder"]),s(u,{onClick:e.handleSearch},{default:l(()=>[C(t(e.$t("header.searchButton")),1)]),_:1},8,["onClick"]),s(u,{type:"primary",link:"",class:"new-address",onClick:e.handleAddAddress},{default:l(()=>[C(t(e.$t("customers.add"))+" ",1),s(F,{content:"地址信息说明",placement:"top"},{default:l(()=>[s(i,{class:"address-help"},{default:l(()=>[s(p)]),_:1})]),_:1})]),_:1},8,["onClick"])]),n("div",G,[s(A,{data:e.customers,style:{width:"100%"},stripe:""},{default:l(()=>[s(m,{prop:"userNo",label:e.$t("customers.code"),width:"150"},null,8,["label"]),s(m,{prop:"userNo",label:e.$t("customers.info.title")},{default:l(({row:o})=>[n("div",H,[n("div",null,[n("div",null,t(e.$t("customers.info.name"))+"："+t(o.userAddressInfo.firstName),1),n("div",null,t(e.$t("customers.info.postcode"))+"："+t(o.userAddressInfo.postcode),1),n("div",null,t(e.$t("customers.info.phoneNumber"))+"："+t(o.userAddressInfo.mobile),1),n("div",null,t(e.$t("customers.info.email"))+"："+t(o.userAddressInfo.email),1),n("div",null,t(e.$t("customers.info.address"))+"："+t(o.userAddressInfo.countryName)+" "+t(o.userAddressInfo.provinceName)+" "+t(o.userAddressInfo.cityName)+" "+t(o.userAddressInfo.address),1)])])]),_:1},8,["label"]),s(m,{prop:"orderCount",label:e.$t("customers.orderCount"),width:"130"},{default:l(({row:o})=>[n("div",{onClick:f=>e.handleOrderLink(o),class:"text-cursor"},t(e.$t("customers.orderCount"))+"："+t(o.orderCount),9,J)]),_:1},8,["label"]),s(m,{prop:"gmtCreate",label:e.$t("commont.createTime"),width:"180"},null,8,["label"]),s(m,{prop:"statusDesc",label:e.$t("commont.operation"),width:"130"},{default:l(o=>[s(u,{type:"text",onClick:f=>e.handleEdit(o.row)},{default:l(()=>[C(t(e.$t("commont.edit")),1)]),_:2},1032,["onClick"]),o.row.orderCount?(V(),O(u,{key:0,type:"text",icon:"el-icon-star-on",class:"star-btn",onClick:f=>e.handleStarClick(o.row)},{default:l(()=>[C(t(e.$t("commont.share")),1)]),_:2},1032,["onClick"])):Q("",!0)]),_:1},8,["label"])]),_:1},8,["data"])]),n("div",K,[n("div",W,t(e.$t("commont.total"))+" "+t(e.total)+" "+t(e.$t("commont.page")),1),s(N,{"current-page":e.pagination.currentPage,"onUpdate:currentPage":r[1]||(r[1]=o=>e.pagination.currentPage=o),"page-size":e.pagination.pageSize,"onUpdate:pageSize":r[2]||(r[2]=o=>e.pagination.pageSize=o),"page-sizes":[10,20,50],total:e.total,layout:"prev, pager, next, sizes",onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),s(S,{modelValue:e.addressDialogVisible,"onUpdate:modelValue":r[3]||(r[3]=o=>e.addressDialogVisible=o),formData:e.formData,subCode:e.formData.userNo,onSubmit:e.handleAddressSubmit},null,8,["modelValue","formData","subCode","onSubmit"])],64)}const te=U(j,[["render",X],["__scopeId","data-v-b63a866d"]]);export{te as default};
