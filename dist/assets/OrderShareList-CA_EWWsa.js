import{a as z}from"./orderList-DHwY1C9a.js";import{C as B,D as q,G as D,r as g,v as P,H as E,E as M,u as O,_ as T,d as c,o as u,f as n,e as o,w as r,i as p,q as t,y as $,F as N,j as A,n as I,g as R}from"./index-TAmHM2dm.js";import"./request-tfwnRnxz.js";import"./currency-BJx3poTv.js";const U=B({name:"OrderList",setup(){O();const s=E(),{proxy:l}=q(),L=({row:a})=>a.isMark?"status-mark":"",h=D({currentPage:1,pageSize:10}),v=D({userNo:"",trackingNo:"",isMark:0}),F=g([]),d=g(0),f=g(!1),k=g(null),C=g({}),m=g(-1),b=g([]),y=g([{status:-1,icon:"icon-all",label:l.$t("package.status.all"),count:"allOrder"},{status:0,icon:"icon-recorded",label:l.$t("package.status.recorded"),count:"enterCount"},{status:1,icon:"icon-qc",label:l.$t("package.status.qc"),count:"qcCount"},{status:10,icon:"icon-shipped",label:l.$t("package.status.waitPay"),count:"sendCount"},{status:11,icon:"icon-processing",label:l.$t("package.status.processing"),count:"signCount"},{status:12,icon:"icon-delivered",label:l.$t("package.status.delivered"),count:"signCount"},{status:13,icon:"icon-finished",label:l.$t("package.status.finished"),count:"signCount"}]);P(async()=>{if(s.query.userNo&&(v.userNo=s.query.userNo),s.query.code)try{const a=await z.decodeSharingCode({code:s.query.code});v.userNo=a.data.userNo}catch(a){console.log(a)}_()});const _=async()=>{try{f.value=!0,k.value=null;let a={pageNo:h.currentPage,pageSize:h.pageSize,...v};a.isMark||delete a.isMark,F.value=[],m.value<10?(a.status=m.value,m.value===-1&&delete a.status):a.status=m.value;const S=await z.sharingListForBusiness(a);F.value=S.data,d.value=S.total}catch(a){k.value=a.message||"获取订单失败",M.error("获取订单列表失败")}finally{f.value=!1}};return{searchForm:v,orders:F,total:d,pagination:h,status:m,flowItems:y,selectedOrders:b,countList:C,handleSizeChange:a=>{h.pageSize=a,_()},handleCurrentChange:a=>{h.currentPage=a,_()},tableRowClassName:L}}}),V={class:"order-list"},j={class:"order-list-content"},G={class:"user-info"},H={key:0},W={key:0},J={key:0},K={class:"timeline"},Q={class:"image-list"},X={key:1,class:"estimate-info"},Y={key:0},Z={class:"timeline"},w={class:"pagination"},x={class:"total"};function ee(s,l,L,h,v,F){const d=p("el-table-column"),f=p("el-timeline-item"),k=p("el-timeline"),C=p("el-popover"),m=p("el-image"),b=p("el-tag"),y=p("el-table"),_=p("el-pagination");return u(),c("div",V,[n("div",j,[o(y,{data:s.orders,onSelectionChange:s.handleSelectionChange,style:{width:"100%"},"row-class-name":s.tableRowClassName},{default:r(()=>[o(d,{prop:"userNo",label:s.$t("package.table.customerCode"),width:"100"},null,8,["label"]),o(d,{prop:"userNo",label:s.$t("package.table.addressInfo"),width:"320"},{default:r(({row:e})=>[n("div",G,[e.status<10?(u(),c("div",H,[n("div",null,t(s.$t("customers.info.name"))+"："+t(e.userAddressInfo.firstName),1),n("div",null,t(s.$t("customers.info.postcode"))+"："+t(e.userAddressInfo.postcode),1),n("div",null,t(s.$t("customers.info.phoneNumber"))+"："+t(e.userAddressInfo.mobile),1),n("div",null,t(s.$t("customers.info.email"))+"："+t(e.userAddressInfo.email),1),n("div",null,t(s.$t("customers.info.address"))+"："+t(e.userAddressInfo.countryName)+" "+t(e.userAddressInfo.provinceName)+" "+t(e.userAddressInfo.cityName)+" "+t(e.userAddressInfo.address),1)])):$("",!0)])]),_:1},8,["label"]),o(d,{prop:"logisticsNumber",label:s.$t("package.table.expressDelivery")},{default:r(({row:e})=>[e.status<10?(u(),c("div",W,[n("div",null,t(s.$t("trackingNumber"))+"："+t(e.logisticsNumber),1),o(C,{width:800},{reference:r(()=>{var i;return[e.trackingList&&e.trackingList.length>0?(u(),c("div",J,t(s.$t("logisticsTrack"))+"："+t(e.trackingList&&((i=e.trackingList[0])==null?void 0:i.logisticsDesc)),1)):$("",!0)]}),default:r(()=>[n("div",K,[o(k,null,{default:r(()=>[(u(!0),c(N,null,A(e.trackingList,(i,a)=>(u(),I(f,{key:a,timestamp:i.gmtTime,placement:"top"},{default:r(()=>[n("p",null,t(i.logisticsDesc),1)]),_:2},1032,["timestamp"]))),128))]),_:2},1024)])]),_:2},1024),n("div",Q,[(u(!0),c(N,null,A(e.imgUrlList,(i,a)=>(u(),c("div",{key:i,class:"block"},[o(m,{class:"image-list-item",style:{width:"60px",height:"60px"},"close-on-press-escape":"","preview-teleported":"",src:i,"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":e.imgUrlList,"initial-index":a,"z-index":"8",fit:"cover"},null,8,["src","preview-src-list","initial-index"])]))),128))])])):(u(),c("div",X,[n("div",null,[n("div",null,"国际单号："+t(e.orderNo),1),n("div",null,"物流线路："+t(e.logisticsLine),1),o(C,{width:800},{reference:r(()=>{var i;return[e.trackingList&&e.trackingList.length>0?(u(),c("div",Y,t(s.$t("logisticsTrack"))+"："+t(e.trackingList&&((i=e.trackingList[0])==null?void 0:i.logisticsDesc)),1)):$("",!0)]}),default:r(()=>[n("div",Z,[o(k,null,{default:r(()=>[(u(!0),c(N,null,A(e.trackingList,(i,a)=>(u(),I(f,{key:a,timestamp:i.gmtTime,placement:"top"},{default:r(()=>[n("p",null,t(i.logisticsDesc),1)]),_:2},1032,["timestamp"]))),128))]),_:2},1024)])]),_:2},1024),n("div",null,"包裹运费："+t(e.estimateFreightPrice),1)]),n("div",null,[n("div",null," 长 "+t(e.length)+"，宽"+t(e.width)+"，高"+t(e.height),1),n("div",null,t(e.realWeight)+"kg；内含8件",1),l[2]||(l[2]=n("div",null,"在途 7 天",-1))])]))]),_:1},8,["label"]),o(d,{prop:"gmtCreate",label:s.$t("commont.createTime"),width:"100"},null,8,["label"]),o(d,{prop:"statusDesc",label:s.$t("package.table.latestStatus"),width:"100"},{default:r(({row:e})=>[o(b,null,{default:r(()=>[R(t(e.statusDesc),1)]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data","onSelectionChange","row-class-name"])]),n("div",w,[n("div",x,t(s.$t("commont.total"))+" "+t(s.total)+" "+t(s.$t("commont.page")),1),o(_,{"current-page":s.pagination.currentPage,"onUpdate:currentPage":l[0]||(l[0]=e=>s.pagination.currentPage=e),"page-size":s.pagination.pageSize,"onUpdate:pageSize":l[1]||(l[1]=e=>s.pagination.pageSize=e),"page-sizes":[10,20,50],total:s.total,layout:"prev, pager, next, sizes",onSizeChange:s.handleSizeChange,onCurrentChange:s.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])}const ie=T(U,[["render",ee],["__scopeId","data-v-3e50d6d1"]]);export{ie as default};
